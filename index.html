<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Special Surprise for Nabila</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        /* Base Styles */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #fce4ec;
            background-image: repeating-linear-gradient(
                -45deg,
                rgba(255, 255, 255, 0.2) 0,
                rgba(255, 255, 255, 0.2) 1px,
                transparent 1px,
                transparent 10px
            ),
            radial-gradient(
                circle at top left,
                #fffbe8 0%,
                #fcd5e4 50%,
                #f0f0f0 100%
            );
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            overflow: hidden;
        }

        /* Main Card Styling */
        .main-card {
            max-width: 400px;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(5px);
            border-radius: 2rem;
            border: 2px solid rgba(255, 255, 255, 0.9);
            position: absolute;
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }

        /* --- STAGE TRANSITION KEYFRAMES --- */
        @keyframes fadeInBounce {
            0% { opacity: 0; transform: scale(0.8) translateY(-20px); }
            80% { opacity: 1; transform: scale(1.02) translateY(5px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }
        .main-card.animate-intro {
            animation: fadeInBounce 1s ease-out forwards;
        }

        @keyframes slideOutLeft { to { opacity: 0; transform: translateX(-100%) scale(0.9); } }
        @keyframes slideInRight { from { opacity: 0; transform: translateX(100%) scale(0.9); } to { opacity: 1; transform: translateX(0) scale(1); } }
        @keyframes slideOutRight { to { opacity: 0; transform: translateX(100%) scale(0.9); } }
        @keyframes slideInLeft { from { opacity: 0; transform: translateX(-100%) scale(0.9); } to { opacity: 1; transform: translateX(0) scale(1); } }

        .main-card.stage-exit-next { animation: slideOutLeft 0.5s ease-in forwards; }
        .main-card.stage-enter-next { animation: slideInRight 0.5s ease-out forwards; }
        .main-card.stage-exit-prev { animation: slideOutRight 0.5s ease-in forwards; }
        .main-card.stage-enter-prev { animation: slideInLeft 0.5s ease-out forwards; }

        /* --- BUTTON ANIMATION (For emphasis) --- */
        .pulse-button {
            transition: all 0.3s ease;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(236, 72, 153, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(236, 72, 153, 0); }
            100% { box-shadow: 0 0 0 0 rgba(236, 72, 153, 0); }
        }

        /* --- ENVELOPE STYLES --- */
        .envelope-container { perspective: 1000px; cursor: pointer; }
        .envelope-front {
            background-color: #f7a2a2; border: 2px solid #e07b7b;
            position: relative; height: 200px;
            transform-style: preserve-3d;
        }
        .envelope-flap {
            transition: transform 1s cubic-bezier(0.4, 0, 0.2, 1), background 1s;
        }
        .envelope-front.opened .envelope-flap { transform: rotateX(180deg); background: #e07b7b; }
        .envelope-paper {
            transform: translateY(-50%) scaleY(0);
            transition: transform 1s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.5s;
        }
        .envelope-front.opened .envelope-paper { transform: translateY(-130%) scaleY(1); }
        
        /* --- CARD FLIP STYLES (Focus of the fix) --- */
        .flip-card {
            perspective: 1000px;
            height: 250px; /* Standardize card height */
        }

        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.4s;
            transform-style: preserve-3d;
        }

        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }

        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .flip-card-front {
            background-color: #ffe4e6;
            border: 2px solid #ffcccb;
            flex-direction: column; /* Allows text to stack */
            justify-content: space-around; /* Distributes content */
        }

        .flip-card-back {
            background-color: #ffffff;
            transform: rotateY(180deg);
            flex-direction: column;
            text-align: center;
            padding: 2rem;
        }

        /* --- KISS PARTICLE EFFECT --- */
        @keyframes confetti-fall {
            0% { opacity: 1; transform: translateY(0) rotate(0deg); }
            100% { opacity: 0; transform: translateY(300px) rotate(360deg); }
        }
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: transparent;
            border-radius: 50%;
            pointer-events: none;
            z-index: 100;
            opacity: 0;
            animation: confetti-fall 2s ease-in forwards;
        }
    </style>
</head>
<body>
    <audio id="background-music" autoplay loop muted>
      <source src="NabilaWeb.mp3" type="audio/mpeg">
      Your browser does not support the audio element.
    </audio>

    <div id="app" class="relative overflow-hidden w-full h-screen flex justify-center items-center">

        <section id="stage-intro" class="main-card p-6 md:p-8 space-y-6">
            <div class="flex justify-between items-start">
                <div class="flex space-x-2">
                    <div class="w-3 h-3 bg-red-400 rounded-full"></div>
                    <div class="w-3 h-3 bg-yellow-400 rounded-full"></div>
                    <div class="w-3 h-3 bg-green-400 rounded-full"></div>
                </div>
                <div class="relative w-16 h-16">
                    <img src="https://placehold.co/64x64/FFB6C1/FFF?text=üéÄ" alt="Hello Kitty Icon" class="absolute -top-6 -right-6 w-20 h-20">
                </div>
            </div>

            <div class="text-center space-y-4">
                <p class="text-sm font-semibold text-pink-500 flex items-center justify-center">
                    A Note for My Kuchupuchu bbe 
                    <span class="ml-1 text-red-500">‚ù§Ô∏è</span>
                </p>
                <h1 class="text-4xl font-extrabold text-pink-600">Hey My Princess! <span class="text-red-500">üíï</span></h1>
                <p class="text-gray-600 leading-relaxed">
                    I wanted to do something special for you, for this princess day, so I made something special just for you...
                </p>
                <p class="font-bold text-pink-500">Click below to see what it is! ‚ú®</p>
            </div>
            
            <div class="flex items-center justify-center">
                <img src="https://placehold.co/64x64/D3D3D3/000?text=üêà" alt="Cat Icon" class="absolute -bottom-4 -left-4 w-16 h-16">

                <button id="startButton" onclick="unmuteMusic(); nextStage()" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition duration-300 hover:scale-105 pulse-button">
                    Open My Heart ‚ù§Ô∏è
                </button>
            </div>

            <p class="text-xs text-gray-400 text-center pt-4">Made with love, only for you jaanüíï</p>
        </section>

        <section id="stage-envelope" class="main-card p-6 md:p-8 space-y-8 hidden">
             <div class="text-center">
                <h2 class="text-3xl font-bold text-red-500">A Love Letter üíå</h2>
                <p class="text-sm text-gray-500">From my heart to yours</p>
            </div>
            
            <div id="envelope-wrapper" class="envelope-container flex justify-center p-4">
                <div id="envelope-front" class="envelope-front w-64 h-48 rounded-lg" onclick="openEnvelope()">
                    <div class="envelope-flap"></div>
                    <div class="envelope-paper p-4 text-left">
                        <p class="text-pink-500 font-bold mb-1">My Sweetest Love</p>
                        <p class="text-gray-700 text-sm">A letter is waiting inside for you. Click anywhere to open...</p>
                    </div>
                    <div class="absolute inset-0 flex justify-center items-center z-20">
                        <div class="w-10 h-10 bg-white rounded-full flex justify-center items-center shadow-md">
                            <i data-lucide="mail" class="text-pink-500 w-6 h-6"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-center space-y-2">
                <p class="text-gray-600">Click to open the envelope</p>
                <p class="text-pink-500 font-semibold text-sm">Special Delivery üîª</p>
            </div>
        </section>

        <section id="stage-letter" class="main-card p-6 md:p-8 space-y-6 hidden">
             <div class="text-center">
                <h2 class="text-3xl font-bold text-red-500">A Love Letter üíå</h2>
                <p class="text-sm text-gray-500">From my heart to yours</p>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-inner border border-gray-100 space-y-4">
                <div class="flex items-center justify-between">
                    <p class="text-xl font-semibold text-pink-500 flex items-center">
                        <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i> My Sweetest Nabila
                    </p>
                    <img src="https://placehold.co/64x64/D3D3D3/000?text=üêà" alt="Cat Icon" class="w-12 h-12">
                </div>

                <p class="text-lg font-serif italic text-pink-500">My shonaa pakhii,</p>
                <p class="text-gray-700 leading-relaxed">
                    Every moment with you feels like a beautiful dream that I never want to wake up from. I want you to know that you are the most precious person in my life. Every day with you is a gift, and I'm grateful for every second we share together. You make me want to be the best version of myself.
                </p>
                
                <div class="flex justify-between items-center pt-4">
                    <div class="w-16 h-16 rounded-full border-4 border-pink-300 text-pink-500 flex flex-col justify-center items-center text-xs font-bold opacity-70">
                        LOVE
                        <span class="text-xs font-normal">STAMPED</span>
                    </div>
                    <p class="text-gray-600 font-serif italic">With all my love, Always yours üíï</p>
                </div>
            </div>

            <button onclick="nextStage()" class="w-full bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition duration-300 hover:scale-105">
                Continue To See More ‚ú®
            </button>
        </section>

        <section id="stage-cards" class="main-card p-6 md:p-8 space-y-6 hidden">
            <div class="text-center">
                <h2 class="text-3xl font-bold text-purple-600">Some Special Cards For You</h2>
                <p class="text-sm text-gray-500">Click each card to reveal a special message!</p>
                <p class="mt-4 font-bold text-pink-500 text-sm">Start by tapping any card above ‚ú®</p>
            </div>

            <div id="card-list" class="space-y-4">
                <div class="flip-card" onclick="flipCard(this, 0)">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <h3 class="text-3xl font-extrabold text-red-500">Hello Kitty Card 1</h3>
                            <p class="text-sm text-pink-400">Tap to discover the message</p>
                        </div>
                        <div class="flip-card-back text-lg font-semibold text-pink-600">
                            I Love u Nabila üíï
                            <p class="text-sm text-gray-500 mt-4">Tap to flip back</p>
                        </div>
                    </div>
                </div>

                <div class="flip-card" onclick="flipCard(this, 1)">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <h3 class="text-3xl font-extrabold text-red-500">Hello Kitty Card 2</h3>
                            <p class="text-sm text-pink-400">Tap to discover the message</p>
                        </div>
                        <div class="flip-card-back text-lg font-semibold text-pink-600">
                            You don't even have to try ‚Äî you just make everything around you feel lighter, warmer, better. ‚ú®
                            <p class="text-sm text-gray-500 mt-4">Tap to flip back</p>
                        </div>
                    </div>
                </div>

                <div class="flip-card" onclick="flipCard(this, 2)">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <h3 class="text-3xl font-extrabold text-red-500">Spidey Kitty Card 3</h3>
                            <p class="text-sm text-pink-400">Tap to discover the message</p>
                        </div>
                        <div class="flip-card-back text-lg font-semibold text-pink-600">
                            The little things you do ‚Äî your expressions, your laughter, the way you talk ‚Äî they've all become my favorite details. üå∏
                            <p class="text-sm text-gray-500 mt-4">Tap to flip back</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="card-status" class="text-center text-sm font-semibold text-gray-500 mt-4 pt-4">
                0 of 3 messages discovered! Keep exploring üíñ
            </div>
            
            <div id="final-modal" class="hidden fixed inset-0 bg-black bg-opacity-30 z-50 flex justify-center items-center p-4">
                <div class="bg-white p-8 rounded-3xl shadow-2xl main-card text-center space-y-4" style="position: relative;">
                    <i data-lucide="party-popper" class="w-10 h-10 mx-auto text-pink-500"></i>
                    <h3 class="text-2xl font-bold text-red-500">I love you soo much Nebula üò≠üòò!</h3>
                    <p class="text-gray-700">Each message is a piece of my heart that belongs to you forever. ‚ú®</p>
                    <button onclick="nextStage()" class="w-full bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition duration-300 hover:scale-105">
                        Open the Final Letter ‚ù§Ô∏è
                    </button>
                    <p class="text-xs text-gray-400">Stay here a bit longer</p>
                </div>
            </div>
        </section>

        <section id="stage-final-letter" class="main-card p-6 md:p-8 space-y-6 hidden">
            <div class="text-center">
                <i data-lucide="mail" class="w-8 h-8 mx-auto text-pink-500 mb-2"></i>
                <h2 class="text-3xl font-bold text-pink-500">Final Love Letter</h2>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-inner border border-gray-100 space-y-4 text-center">
                <p class="text-xl font-serif italic text-purple-600">My sweetest cutie bouu,</p>
                <p class="text-gray-700 leading-relaxed text-left">
                    You're the calm I reach for and the laugh that brightens my day. I hope this tiny world made you smile ‚Äî and whispered how much you mean to me. I'll keep making memories, big and small, always with you. Forever yours, in every little universe.
                </p>
                <p class="text-sm text-black-500 pt-4">                       „Ö§„Ö§„Ö§„Ö§„Ö§ Forever yours, Ariyan</p>
            </div>

            <div class="flex space-x-4">
                <button onclick="sealLetter()" class="flex-1 bg-red-400 hover:bg-red-500 text-white font-bold py-3 px-4 rounded-full shadow-lg transform transition duration-300 hover:scale-105">
                    Seal this Letter ‚ù§Ô∏è
                </button>
                <button onclick="resetApp()" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-3 px-4 rounded-full shadow-lg transform transition duration-300 hover:scale-105">
                    Restart
                </button>
            </div>
        </section>

        <section id="stage-sealed" class="main-card p-6 md:p-8 space-y-6 hidden">
             <div class="text-center">
                <div class="w-20 h-20 rounded-full bg-pink-100 border-4 border-pink-300 flex justify-center items-center mx-auto mb-4">
                    <i data-lucide="heart" class="w-10 h-10 text-red-500 fill-red-500"></i>
                </div>
                <h2 class="text-3xl font-bold text-pink-500">I LOVE YOU NEBULA</h2>
                <div id="heart-status" class="flex justify-center space-x-2 text-xl mt-3 text-red-400">
                    <span>‚ô°</span><span>‚ô°</span><span>‚ô°</span><span>‚ô°</span><span>‚ô°</span>
                </div>
            </div>

            <div class="text-center space-y-2 pt-4">
                <p class="text-2xl font-bold text-gray-700">Always Yours üíï</p>
                <p id="current-date" class="text-sm text-gray-500">Tuesday, November 18, 2025</p>
            </div>

            <button onclick="resetApp()" class="w-full bg-green-400 hover:bg-green-500 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition duration-300 hover:scale-105">
                Experience Again ‚ú®
            </button>
            <button onclick="showKiss()" class="w-full bg-red-400 hover:bg-red-500 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition duration-300 hover:scale-105 relative overflow-hidden">
                Send a Virtual Kissi üíã
            </button>
        </section>

        <div id="kiss-area" class="fixed bottom-0 left-0 right-0 h-16 pointer-events-none z-50"></div>

    </div>

    <script>
        // --- Configuration & State ---
        let currentStage = 0; 
        let flippedCards = [false, false, false];
        // Stages: 0: Intro, 1: Envelope, 2: Letter, 3: Cards, 4: Final Letter, 5: Sealed
        const stages = ['stage-intro', 'stage-envelope', 'stage-letter', 'stage-cards', 'stage-final-letter', 'stage-sealed'];
        
        // --- DOM Elements ---
        const envelopeFront = document.getElementById('envelope-front');
        const cardStatus = document.getElementById('card-status');
        const finalModal = document.getElementById('final-modal');
        const backgroundMusic = document.getElementById('background-music');

        // --- Utility Functions ---

        function unmuteMusic() {
            if (backgroundMusic && backgroundMusic.muted) {
                backgroundMusic.muted = false;
                backgroundMusic.play().catch(e => console.error("Autoplay/Unmute failed:", e));
                document.getElementById('startButton').classList.remove('pulse-button');
            }
        }
        
        function renderPage(prevStageId, nextStageId, direction = 'next') {
            const prevElement = document.getElementById(prevStageId);
            const nextElement = document.getElementById(nextStageId);

            if (prevElement) {
                prevElement.classList.remove('animate-intro', 'stage-enter-next', 'stage-enter-prev'); 
                prevElement.classList.add(direction === 'next' ? 'stage-exit-next' : 'stage-exit-prev');
            }

            if (nextElement) {
                nextElement.classList.remove('hidden', 'stage-exit-next', 'stage-exit-prev');
                nextElement.classList.add(direction === 'next' ? 'stage-enter-next' : 'stage-enter-prev');
            }
            
            if (currentStage === 0 && nextElement) {
                nextElement.classList.remove('stage-enter-next', 'stage-enter-prev'); 
                nextElement.classList.add('animate-intro');
            }
            
            // Clean up and reset classes after animation finishes
            setTimeout(() => {
                if (prevElement) {
                    prevElement.classList.add('hidden');
                    // Reset to base classes for next use
                    prevElement.className = 'main-card p-6 md:p-8 space-y-6 hidden'; 
                }
                if (nextElement) {
                    nextElement.classList.remove('stage-enter-next', 'stage-enter-prev'); 
                }
                 lucide.createIcons();
                 updateCardStatus();
                 if (currentStage === 5) {
                    document.getElementById('current-date').textContent = new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                 }
            }, 500);
        }

        function nextStage() {
            if (currentStage >= stages.length - 1) return;

            const prevId = stages[currentStage];
            currentStage++;
            const nextId = stages[currentStage];
            
            renderPage(prevId, nextId, 'next');
        }
        
        // --- Stage Specific Logic ---

        function openEnvelope() {
            if (envelopeFront.classList.contains('opened')) {
                nextStage();
            } else {
                envelopeFront.classList.add('opened');
                setTimeout(nextStage, 1500); 
            }
        }

        function flipCard(cardElement, index) {
            const innerCard = cardElement.querySelector('.flip-card-inner');
            
            // Toggle the flip
            if (innerCard.classList.contains('flipped')) {
                innerCard.classList.remove('flipped');
                cardElement.classList.remove('flipped'); // Add this for consistency
            } else {
                innerCard.classList.add('flipped');
                cardElement.classList.add('flipped'); // Add this for consistency
                
                // Only count as discovered if it was not flipped before
                if (!flippedCards[index]) {
                    flippedCards[index] = true;
                    updateCardStatus();
                }
            }
        }

        function updateCardStatus() {
            const discoveredCount = flippedCards.filter(f => f).length;
            cardStatus.textContent = `${discoveredCount} of 3 messages discovered! Keep exploring üíñ`;

            if (discoveredCount === 3) {
                // Show final modal once all cards are flipped
                finalModal.classList.remove('hidden');
            }
        }

        function sealLetter() {
             nextStage();
        }
        
        function resetApp() {
            const prevId = stages[currentStage];
            currentStage = 0;
            flippedCards = [false, false, false];
            envelopeFront.classList.remove('opened');
            finalModal.classList.add('hidden');
            
            const nextId = stages[currentStage];
            renderPage(prevId, nextId, 'prev');

            document.getElementById('startButton').classList.add('pulse-button');
            backgroundMusic.muted = true;
        }

        // --- Confetti/Kiss Animation ---
        function showKiss() {
            const colors = ['#FFC0CB', '#FF69B4', '#FFB6C1', '#F08080'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                
                const startX = Math.random() * 80 + 10;
                const startY = Math.random() * 20 - 10;

                confetti.style.left = `${startX}vw`;
                confetti.style.top = `${startY}vh`;
                confetti.style.width = confetti.style.height = `${Math.random() * 8 + 4}px`;
                confetti.style.animationDelay = `${Math.random() * 0.5}s`;
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;

                document.body.appendChild(confetti);

                setTimeout(() => confetti.remove(), 2500);
            }
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            renderPage(null, stages[0]);
            document.getElementById('startButton').addEventListener('click', unmuteMusic);
        });
    </script>
</body>
</html>
